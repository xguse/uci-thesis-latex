% Figure / table inputs

\chapter{Approach and Custom Software solutions} \label{chap:3}
\todo[inline]{replace CITEME tags in Approach and Custom Software solutions}


Functional Genomics can be thought of as a problem of generating meaningful gene-sets.
Signal-to-noise is major challenge in generating useful gene-sets. This project aims to generate meaningful gene-sets through integration of multiple supporting data-types

\begin{itemize}
    \item comparative genomics (N-way 1-to-1 orthologs)
    \item comparative transcriptomics (identical RNA-seq experiments on divergent Mosquito species with shared trait: bloodfeeding)
    \item phylogenetics (estimated divergence since last common ancestor)
    \item existing knowledge about certain bloodmeal related transcriptional control programs (\gls{20E} interacting \gls{TFBS} motifs)
\end{itemize}




\paragraph*{Comparative Genomics:}

The initial gene-set for this project was limited to genes that have exactly one matching 1-to-1 ortholog in \Aa, \Ag, \As, and \Cq.
The purpose of this decision is to maximize the probability of conserved function between genes analyzed. 

This preliminary gene set was obtained through the orthoDB7 \url{http://cegg.unige.ch/orthodb7} website by first selecting the node representing only the mosquito branch of the phylogeny \cite{Waterhouse2013}.
Then the following requirements were enforced when retrieving ortholog relationship results 

\begin{quotation}
    \texttt{co-ortholog copy-number: AAEGY=1, AGAMB=1, ASTEP=1, CQUIN=1}
\end{quotation}


The results of the query are provided as file \texttt{orthodb7\_mosqs\_20130918.txt} in the supplementary data files associated with this dissertation \url{http://dx.doi.org/10.6084/m9.figshare.810442} \cite{Dunn2013dissSupl}.
 
Custom python code was used to extract the 1-to-1 orthologs for \Aa, \Ag, and \Cq. The coded process is provided as an executable IPython notebook located at \url{http://goo.gl/EM1pHL} for in-depth inspection as well as for the purpose of openness and reproducibility.

Briefly, the results table was filtered for data pertaining to \Aa, \Ag, or \Cq.
Then I built a graph-representation of the data such that each orthoDB ortholog group could be queried to ensure that exactly one gene was represented for each species.
These genes represent gene-set that formed the starting point for the rest of my approach.
The filtered set is available as supplementary file `AaAgCq\_1to1\_orthos.tsv`.

It should be noted that while this set contains only genes from the three species included in this document, each group should also have exactly one ortholog from \As\ as well.

\paragraph*{Comparative Transcriptomics:}

One of this study's aims is to identify and analyze orthologous genes that exhibit correlated \glspl{mAP} in the midguts of females directly following the ingestion of a bloodmeal.
To this end, whole RNA was extracted from dissected midguts of 16 female individuals of each species among the following time points: \gls{NBF} (0), 2, 4, 6, 8, 10 h \gls{PBM} (Protocol \ref{prtcl:RNA-extraction}).


\paragraph*{Phylogenetics:}

The phylogenetics aspect of this approach consists of using the estimated phylogenetic distances between each species to weight the comparisons between data correlations calculated for each pairwise 1-to-1 ortholog duo.
This is encoded as $d$ in the \gls{PTCI} expression defined in Equation \ref{eq:ptci}.

The range of  $d$ for each species-pair has been estimated previously (compiled in \cite{Sieglaff2009}) and were as follows:
- \Aa:\Ag = 145 MYA
- \Ag:\Cq = 145 MYA
- \Aa:\Cq = 22 MYA  


\paragraph*{Targeting Specific Transcriptional Control Mechanisms:}

Part of the gls{PTCI} includes correlation of a gls{TFBS} scanning signature between ortholog pairs.
If the gls{PTCI} is calculated using a set of gls{TFBS} that are known to interact with the 20E signaling cascade, then this portion of the gls{PTCI} acts as a rough proxy for correlation with putative activity of  the 20E cascade.

This is an imperfect solution as ChIP-Seq using antibodies to these TFs in each species is preferable.
However this was impractical for this work due to the absence of suitable antibodies and the cost of developing and executing all assays in each species.


\paragraph{Custom Software Solutions:}

Two core bodies of software were developed for this project.
Blacktie is a python package that automates data flow between and record keeping for analysis runs of the components of the third-party analysis pipeline dubbed the Tuxedo Protocol \cite{Trapnell2012}.
The purpose of the second software project \gls{gFunc} is to provide a framework to integrate many, disparate data types to facilitate the synthesis of functional genomics analyses that make use of as many types of data as may be useful.

Blacktie's code and documentation have been made available to the public.
It is hosted as a git project with the complete history of commits included and available for easy open source improvement and collaboration.
It is also available as an easily installable package from the \gls{PyPI} for general users.
It has been downloaded and installed over 1000 times as of this time with its latest version being downloaded 284 times.

gls{gFunc} is based around an existing, well known, and well maintained network-graph framework called networkx \cite{Hagberg2008}. gls{gFunc} uses this code base as a database backbone and provides a framework for installing common genomic data-types into the graph structure as well as a convention for extending the core objects of gls{gFunc} to handle new types of data.
The project is not formally released.
After using it for my own work I have learned more about how best to organize the code.
Once it has been re-factored to incorporate the lessons learned here (mainly that the core objects should be simplified as much as possible and more of the data management should be coded directly with networkx rather than re-implementing certain functions) it will be release to the public.



\section{The phylogenetic transcriptional correspondence index (PTCI)}


Look at the parameter space of the \gls{PTCI} (Figure \ref{fig:ptci-space}).

\input{figures/ptci-space}

Here is the gls{PTCI} calculation:
\input{equations/ptci}

The graph model is useful (Figure \ref{fig:nway-ortholog-graph})

\input{figures/nway-ortholog-graph}


\pagebreak[4]
\section{Blacktie RNA-seq pipeline}

See Figure \ref{fig:tuxedo}


\input{figures/tuxedo}




%%% Local Variables: ***
%%% mode: latex ***
%%% TeX-master: "thesis.tex" ***
%%% End: ***
